import{t as k,b as i,c as u}from"../chunks/D_KWk5Nw.js";import{u as C,y as g,z as d,x as O,A as s,B as h,C as n,D as z,F as L}from"../chunks/CC9dK-lx.js";import{i as p,p as P}from"../chunks/DoB9PtKK.js";import{P as _,s as x}from"../chunks/bQjU_EIn.js";import{o as R}from"../chunks/BCbcSoMx.js";var T=k('<a>Setup OwnTracks App</a> <a download="otrc.json">(OTRC file)</a>',1),U=k('<h1>Setup</h1> <!> <p><a href="/">Home</a></p>',1);function J(w,b){C(b,!0);let t=h("loading"),m=h(void 0);R(async()=>{try{const a=await fetch(`${_}/otrc`);if(a.status==403)s(t,"invalid");else if(a.ok){const o=await a.json(),r=JSON.stringify(o);s(m,P(btoa(r))),s(t,"ok")}else s(t,"error")}catch(a){console.log(a),s(t,"error")}});var v=U(),y=g(d(v),2);{var A=a=>{var o=T(),r=d(o),f=g(r,2);x(f,"href",`${_}/otrc`),L(()=>x(r,"href",`owntracks:///config?inline=${n(m)??""}`)),i(a,o)},S=(a,o)=>{{var r=e=>{var c=u("Authorization failed or configuration has expired.");i(e,c)},f=(e,c)=>{{var j=l=>{var B=u("An error occurred while loading the setup configuration.");i(l,B)};p(e,l=>{n(t)==="error"&&l(j)},c)}};p(a,e=>{n(t)==="invalid"?e(r):e(f,!1)},o)}};p(y,a=>{n(t)==="ok"?a(A):a(S,!1)})}z(2),i(w,v),O()}export{J as component};
